<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SFI Study Tracker</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Syne:wght@400;700;800&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #0d1117;
    --surface: #161b22;
    --border: #30363d;
    --text: #e6edf3;
    --muted: #7d8590;
    --accent: #39d353;
    --accent2: #26a641;
    --accent3: #006d32;
    --accent4: #0e4429;
    --empty: #161b22;
    --red: #f85149;
    --yellow: #d29922;
  }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    min-height: 100vh;
    padding: 32px 24px;
  }

  .container { max-width: 860px; margin: 0 auto; }

  header {
    margin-bottom: 36px;
  }

  h1 {
    font-family: 'Syne', sans-serif;
    font-size: 28px;
    font-weight: 800;
    letter-spacing: -0.5px;
    color: var(--text);
  }

  h1 span { color: var(--accent); }

  .subtitle {
    color: var(--muted);
    font-size: 13px;
    margin-top: 4px;
  }

  /* Stats bar */
  .stats {
    display: flex;
    gap: 16px;
    margin-bottom: 28px;
    flex-wrap: wrap;
  }

  .stat-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 14px 20px;
    flex: 1;
    min-width: 120px;
  }

  .stat-label { font-size: 11px; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; }
  .stat-value { font-size: 24px; font-weight: 700; color: var(--accent); margin-top: 4px; font-family: 'Syne', sans-serif; }

  /* Graph */
  .graph-section {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 24px;
    margin-bottom: 24px;
  }

  .graph-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
  }

  .graph-title { font-size: 13px; color: var(--muted); }

  .month-labels {
    display: flex;
    gap: 0;
    margin-bottom: 6px;
    padding-left: 28px;
    font-size: 11px;
    color: var(--muted);
  }

  .graph-body { display: flex; gap: 4px; }

  .day-labels {
    display: flex;
    flex-direction: column;
    gap: 3px;
    margin-right: 4px;
    font-size: 10px;
    color: var(--muted);
    padding-top: 2px;
  }

  .day-label { height: 13px; line-height: 13px; }

  .grid {
    display: flex;
    gap: 3px;
    flex-wrap: nowrap;
    overflow-x: auto;
  }

  .week-col { display: flex; flex-direction: column; gap: 3px; }

  .day-cell {
    width: 13px;
    height: 13px;
    border-radius: 2px;
    background: var(--empty);
    border: 1px solid rgba(255,255,255,0.04);
    cursor: pointer;
    transition: transform 0.1s, border-color 0.1s;
    flex-shrink: 0;
    position: relative;
  }

  .day-cell:hover { transform: scale(1.4); border-color: var(--accent); z-index: 10; }
  .day-cell.future { opacity: 0.3; cursor: default; }
  .day-cell.future:hover { transform: none; border-color: rgba(255,255,255,0.04); }

  .day-cell[data-level="1"] { background: var(--accent4); }
  .day-cell[data-level="2"] { background: var(--accent3); }
  .day-cell[data-level="3"] { background: var(--accent2); }
  .day-cell[data-level="4"] { background: var(--accent); }

  .legend {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 11px;
    color: var(--muted);
    margin-top: 12px;
    justify-content: flex-end;
  }

  .legend-cell {
    width: 13px; height: 13px;
    border-radius: 2px;
    border: 1px solid rgba(255,255,255,0.04);
  }

  /* Log form */
  .log-section {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 24px;
    margin-bottom: 24px;
  }

  .section-title {
    font-family: 'Syne', sans-serif;
    font-size: 16px;
    font-weight: 700;
    margin-bottom: 18px;
    color: var(--text);
  }

  .form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-bottom: 12px;
  }

  .form-group { display: flex; flex-direction: column; gap: 6px; }
  .form-group.full { grid-column: 1 / -1; }

  label { font-size: 11px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.8px; }

  input, select, textarea {
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 6px;
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    padding: 10px 12px;
    outline: none;
    transition: border-color 0.2s;
    width: 100%;
  }

  input:focus, select:focus, textarea:focus { border-color: var(--accent); }
  textarea { resize: vertical; min-height: 70px; }
  select option { background: var(--bg); }

  .btn {
    background: var(--accent3);
    border: none;
    border-radius: 6px;
    color: var(--text);
    cursor: pointer;
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    font-weight: 600;
    padding: 11px 24px;
    transition: background 0.2s, transform 0.1s;
    width: 100%;
  }

  .btn:hover { background: var(--accent2); }
  .btn:active { transform: scale(0.98); }

  /* History */
  .history-section {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 24px;
  }

  .entry {
    border-left: 2px solid var(--accent3);
    padding: 12px 16px;
    margin-bottom: 10px;
    background: var(--bg);
    border-radius: 0 6px 6px 0;
    animation: slideIn 0.2s ease;
  }

  @keyframes slideIn {
    from { opacity: 0; transform: translateX(-8px); }
    to { opacity: 1; transform: translateX(0); }
  }

  .entry-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
  .entry-date { font-size: 11px; color: var(--accent); font-weight: 600; }
  .entry-topic { font-size: 14px; font-weight: 600; }
  .entry-meta { font-size: 11px; color: var(--muted); margin-top: 4px; }
  .entry-notes { font-size: 12px; color: var(--muted); margin-top: 6px; font-style: italic; }

  .delete-btn {
    background: none;
    border: none;
    color: var(--muted);
    cursor: pointer;
    font-size: 14px;
    padding: 2px 6px;
    border-radius: 4px;
    transition: color 0.2s, background 0.2s;
  }
  .delete-btn:hover { color: var(--red); background: rgba(248,81,73,0.1); }

  .empty-state { color: var(--muted); font-size: 13px; text-align: center; padding: 24px; }

  .tooltip {
    position: fixed;
    background: #1c2128;
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 8px 12px;
    font-size: 12px;
    color: var(--text);
    pointer-events: none;
    z-index: 100;
    display: none;
    white-space: nowrap;
  }

  .streak-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: rgba(57,211,83,0.1);
    border: 1px solid rgba(57,211,83,0.3);
    border-radius: 20px;
    padding: 4px 12px;
    font-size: 12px;
    color: var(--accent);
    margin-top: 8px;
  }
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>SFI <span>Study Tracker</span></h1>
    <div class="subtitle">log your sessions ¬∑ track your streak ¬∑ keep going</div>
    <div class="streak-badge" id="streakBadge">üî• 0 day streak</div>
  </header>

  <div class="stats">
    <div class="stat-card">
      <div class="stat-label">Total Sessions</div>
      <div class="stat-value" id="statSessions">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Total Hours</div>
      <div class="stat-value" id="statHours">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">This Week</div>
      <div class="stat-value" id="statWeek">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Best Streak</div>
      <div class="stat-value" id="statBest">0</div>
    </div>
  </div>

  <div class="graph-section">
    <div class="graph-header">
      <span class="graph-title">study activity ‚Äî last 12 months</span>
    </div>
    <div class="month-labels" id="monthLabels"></div>
    <div class="graph-body">
      <div class="day-labels">
        <div class="day-label"></div>
        <div class="day-label">Mon</div>
        <div class="day-label"></div>
        <div class="day-label">Wed</div>
        <div class="day-label"></div>
        <div class="day-label">Fri</div>
        <div class="day-label"></div>
      </div>
      <div class="grid" id="grid"></div>
    </div>
    <div class="legend">
      Less
      <div class="legend-cell" style="background:var(--empty)"></div>
      <div class="legend-cell" style="background:var(--accent4)"></div>
      <div class="legend-cell" style="background:var(--accent3)"></div>
      <div class="legend-cell" style="background:var(--accent2)"></div>
      <div class="legend-cell" style="background:var(--accent)"></div>
      More
    </div>
  </div>

  <div class="log-section">
    <div class="section-title">+ Log a session</div>
    <div class="form-grid">
      <div class="form-group">
        <label>Date</label>
        <input type="date" id="inputDate">
      </div>
      <div class="form-group">
        <label>Time (minutes)</label>
        <input type="number" id="inputTime" placeholder="e.g. 45" min="1">
      </div>
      <div class="form-group">
        <label>Topic / Unit</label>
        <input type="text" id="inputTopic" placeholder="e.g. Grammar Unit 3">
      </div>
      <div class="form-group">
        <label>Difficulty</label>
        <select id="inputDiff">
          <option value="1">‚≠ê Easy</option>
          <option value="2">‚≠ê‚≠ê Okay</option>
          <option value="3" selected>‚≠ê‚≠ê‚≠ê Medium</option>
          <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Hard</option>
          <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Very Hard</option>
        </select>
      </div>
      <div class="form-group full">
        <label>Notes (optional)</label>
        <textarea id="inputNotes" placeholder="What did you learn? What to review?"></textarea>
      </div>
    </div>
    <button class="btn" onclick="logSession()">Log Session</button>
  </div>

  <div class="history-section">
    <div class="section-title">Session History</div>
    <div id="historyList"><div class="empty-state">No sessions yet. Log your first one above!</div></div>
  </div>
</div>

<div class="tooltip" id="tooltip"></div>

<script>
  let sessions = JSON.parse(localStorage.getItem('sfi_sessions') || '[]');

  // Set today's date
  document.getElementById('inputDate').value = new Date().toISOString().split('T')[0];

  function save() { localStorage.setItem('sfi_sessions', JSON.stringify(sessions)); }

  function logSession() {
    const date = document.getElementById('inputDate').value;
    const time = parseInt(document.getElementById('inputTime').value);
    const topic = document.getElementById('inputTopic').value.trim();
    const diff = parseInt(document.getElementById('inputDiff').value);
    const notes = document.getElementById('inputNotes').value.trim();

    if (!date || !time || !topic) { alert('Please fill in date, time, and topic.'); return; }

    sessions.push({ id: Date.now(), date, time, topic, diff, notes });
    sessions.sort((a, b) => b.date.localeCompare(a.date));
    save();
    render();

    document.getElementById('inputTime').value = '';
    document.getElementById('inputTopic').value = '';
    document.getElementById('inputNotes').value = '';
    document.getElementById('inputDiff').value = '3';
    document.getElementById('inputDate').value = new Date().toISOString().split('T')[0];
  }

  function deleteSession(id) {
    sessions = sessions.filter(s => s.id !== id);
    save();
    render();
  }

  function getDateMap() {
    const map = {};
    for (const s of sessions) {
      map[s.date] = (map[s.date] || 0) + s.time;
    }
    return map;
  }

  function getLevel(minutes) {
    if (!minutes) return 0;
    if (minutes < 30) return 1;
    if (minutes < 60) return 2;
    if (minutes < 120) return 3;
    return 4;
  }

  function calcStreak() {
    const dateMap = getDateMap();
    const today = new Date();
    let streak = 0, best = 0, cur = 0;

    const d = new Date(today);
    while (true) {
      const key = d.toISOString().split('T')[0];
      if (dateMap[key]) { streak++; d.setDate(d.getDate() - 1); } else break;
    }

    const allDates = Object.keys(dateMap).sort();
    let prev = null;
    for (const dt of allDates) {
      if (prev) {
        const p = new Date(prev), c = new Date(dt);
        const diff = (c - p) / 86400000;
        if (diff === 1) cur++; else cur = 1;
      } else cur = 1;
      best = Math.max(best, cur);
      prev = dt;
    }

    return { streak, best };
  }

  function renderGraph() {
    const grid = document.getElementById('grid');
    const monthLabels = document.getElementById('monthLabels');
    grid.innerHTML = '';
    monthLabels.innerHTML = '';

    const dateMap = getDateMap();
    const today = new Date();
    const end = new Date(today);
    const start = new Date(today);
    start.setFullYear(start.getFullYear() - 1);

    // Go to Sunday of start week
    const startDay = new Date(start);
    startDay.setDate(startDay.getDate() - startDay.getDay());

    const tooltip = document.getElementById('tooltip');
    const weeks = [];
    let cur = new Date(startDay);
    let lastMonth = -1;
    const monthPositions = [];
    let weekIdx = 0;

    while (cur <= end) {
      const week = [];
      for (let d = 0; d < 7; d++) {
        week.push(new Date(cur));
        cur.setDate(cur.getDate() + 1);
      }
      weeks.push(week);

      const firstVisibleDay = week.find(d => d >= start && d <= end);
      if (firstVisibleDay && firstVisibleDay.getMonth() !== lastMonth) {
        monthPositions.push({ idx: weekIdx, month: firstVisibleDay.getMonth(), year: firstVisibleDay.getFullYear() });
        lastMonth = firstVisibleDay.getMonth();
      }
      weekIdx++;
    }

    // Month labels
    const monthNames = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    let labelHtml = '';
    let prevIdx = 0;
    for (let i = 0; i < monthPositions.length; i++) {
      const gap = monthPositions[i].idx - (i === 0 ? 0 : monthPositions[i-1].idx);
      labelHtml += `<span style="min-width:${gap * 16}px;display:inline-block">${monthNames[monthPositions[i].month]}</span>`;
    }
    monthLabels.innerHTML = labelHtml;

    // Cells
    for (const week of weeks) {
      const col = document.createElement('div');
      col.className = 'week-col';
      for (const day of week) {
        const cell = document.createElement('div');
        cell.className = 'day-cell';
        const key = day.toISOString().split('T')[0];
        const mins = dateMap[key] || 0;
        const level = getLevel(mins);
        if (day > today) { cell.classList.add('future'); }
        else { cell.dataset.level = level; }

        cell.addEventListener('mouseenter', (e) => {
          const daySessions = sessions.filter(s => s.date === key);
          const label = day.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric', year: 'numeric' });
          tooltip.style.display = 'block';
          tooltip.innerHTML = mins
            ? `<strong>${label}</strong><br>${mins} min ¬∑ ${daySessions.length} session${daySessions.length > 1 ? 's' : ''}`
            : `<strong>${label}</strong><br>No study`;
        });
        cell.addEventListener('mousemove', (e) => {
          tooltip.style.left = (e.clientX + 14) + 'px';
          tooltip.style.top = (e.clientY - 10) + 'px';
        });
        cell.addEventListener('mouseleave', () => { tooltip.style.display = 'none'; });

        col.appendChild(cell);
      }
      grid.appendChild(col);
    }
  }

  function renderStats() {
    const total = sessions.length;
    const totalMins = sessions.reduce((s, x) => s + x.time, 0);
    const weekAgo = new Date(); weekAgo.setDate(weekAgo.getDate() - 7);
    const weekKey = weekAgo.toISOString().split('T')[0];
    const thisWeek = sessions.filter(s => s.date >= weekKey).length;
    const { streak, best } = calcStreak();

    document.getElementById('statSessions').textContent = total;
    document.getElementById('statHours').textContent = (totalMins / 60).toFixed(1);
    document.getElementById('statWeek').textContent = thisWeek;
    document.getElementById('statBest').textContent = best;
    document.getElementById('streakBadge').textContent = `üî• ${streak} day streak`;
  }

  function renderHistory() {
    const list = document.getElementById('historyList');
    if (!sessions.length) {
      list.innerHTML = '<div class="empty-state">No sessions yet. Log your first one above!</div>';
      return;
    }
    const diffLabels = ['','‚≠ê Easy','‚≠ê‚≠ê Okay','‚≠ê‚≠ê‚≠ê Medium','‚≠ê‚≠ê‚≠ê‚≠ê Hard','‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Very Hard'];
    list.innerHTML = sessions.slice(0, 30).map(s => `
      <div class="entry">
        <div class="entry-header">
          <span class="entry-date">${s.date}</span>
          <button class="delete-btn" onclick="deleteSession(${s.id})">‚úï</button>
        </div>
        <div class="entry-topic">${s.topic}</div>
        <div class="entry-meta">${s.time} min ¬∑ ${diffLabels[s.diff]}</div>
        ${s.notes ? `<div class="entry-notes">"${s.notes}"</div>` : ''}
      </div>
    `).join('');
  }

  function render() {
    renderGraph();
    renderStats();
    renderHistory();
  }

  render();
</script>
</body>
</html>